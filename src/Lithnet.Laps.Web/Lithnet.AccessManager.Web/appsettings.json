{
  "Hosting": {
    "Environment": "HttpSys",
    "HttpSys": {
      "HttpPort": 5000,
      "HttpsPort": 5001,
      "Hostname": "localhost",
      "MaxAccepts": 100,
      "EnableResponseCaching": false,
      "ThrowWriteExceptions": false,
      "MaxConnections": 100,
      "RequestQueueLimit": 1000,
      "MaxRequestBodySize": 2480000,
      "AllowSynchronousIO": false,
      "Http503Verbosity": "Limited",
      "ClientCertificateMethod": "NoCertificate"
    }
  },
  "Authentication": {
    "Mode": "Iwa",
    "Iwa": {
      "AuthenticationSchemes": "Negotiate",
      "ClaimName": "http://schemas.microsoft.com/ws/2008/06/identity/claims/primarysid",
      "IdpLogout": false
    },
    "Oidc": {
      "Authority": "bla",
      "ClientID": "bla",
      "ResponseType": "code id_token",
      "Secret": "bla",
      "ClaimName": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn",
      "IdpLogout": true,
      "Scopes": [
        "profile",
        "openid"
      ]
    },
    "WsFed": {
      "Metadata": "bla",
      "Realm": "bla",
      "ClaimName": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn",
      "IdpLogout": true
    }
  },
  "Authorization": {
    "PowershellProvider": {
      "ScriptFile": "scripts\\authzsample.ps1",
      "Enabled": true,
      "ScriptTimeout": 30
    },
    "JsonProvider": {
      "AuthorizationFile": "targets.json",
      "Enabled": true
    },
    "BuiltInProvider": {
      "Targets": [
        {
          "Id": "dde40d7b-9d97-4983-8b67-b5d19094fdbe",
          "Target": "S-1-5-21-639624971-2667923174-1539603190-3359",
          "Description": "Use a PowerShell script to determine access to PC1",
          "Type": "Computer",
          "AuthorizationMode": "PowershellScript",
          "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
          "Script": "AuthZSample.ps1",
          "Jit": {
            "AuthorizingGroup": "S-1-5-21-639624971-2667923174-1539603190-3364",
            "ExpireAfter": "04:00:00"
          },
          "Laps": {
            "ExpireAfter": "01:00:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [
              "fa5da8fc-3bfd-49b2-844c-9d69f5d56a1b"
            ],
            "OnSuccess": [
              "fa5da8fc-3bfd-49b2-844c-9d69f5d56a1b"
            ]
          }
        },
        {
          "Id": "d6e4a8a1-a82d-40f0-b3b9-0c1b986e262a",
          "Target": "DC=idmdev1,dc=local",
          "Description": "Grant domain admins access to all computers in idmdev1",
          "Type": "Container",
          "AuthorizationMode": "SecurityDescriptor",
          "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;BA)",
          "Jit": {
            "AuthorizingGroup": "EXTDEV\\G-GG-1",
            "ExpireAfter": "01:00:00"
          },
          "Laps": {
            "ExpireAfter": "01:00:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [
              "email-domain-admins"
            ],
            "OnSuccess": [
              "email-domain-admins"
            ]
          }
        },
        {
          "Id": "9dc37cc2-45fc-4c53-a397-aa4e84012211",
          "Target": "OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
          "Description": "Grant ryan access to LAPS testing computer in extdev1",
          "Type": "Container",
          "AuthorizationMode": "SecurityDescriptor",
          "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
          "Jit": {
            "AuthorizingGroup": "S-1-5-21-639624971-2667923174-1539603190-3364",
            "ExpireAfter": "03:00:00"
          },
          "Laps": {
            "ExpireAfter": "01:30:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [
              "a3a619da-effb-48e4-8e6d-7a5875bec0d3"
            ],
            "OnSuccess": [
              "a3a619da-effb-48e4-8e6d-7a5875bec0d3"
            ]
          }
        },
        {
          "Id": "e527068a-1ab0-4438-ad9b-5bd53b9753e6",
          "Target": "S-1-5-21-639624971-2667923174-1539603190-3359",
          "Description": "Grant admins access JIT access to pc1",
          "Type": "Computer",
          "AuthorizationMode": "SecurityDescriptor",
          "SecurityDescriptor": "O:SYD:AR(A;;0x800;;;BA)",
          "Jit": {
            "AuthorizingGroup": "S-1-5-21-639624971-2667923174-1539603190-3370",
            "ExpireAfter": "00:00:15"
          },
          "Laps": {
            "ExpireAfter": "02:00:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [
              "email-domain-admins"
            ],
            "OnSuccess": [
              "email-domain-admins"
            ]
          }
        },
        {
          "Id": "95348587-f543-487d-a8ad-328bc3e5adcf",
          "Target": "S-1-5-21-639624971-2667923174-1539603190-3359",
          "Description": "Grant ryan full access to pc1",
          "Type": "Computer",
          "AuthorizationMode": "SecurityDescriptor",
          "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
          "Jit": {
            "AuthorizingGroup": "IDMDEV1\\JIT-{computername}",
            "ExpireAfter": "02:00:00"
          },
          "Laps": {
            "ExpireAfter": "01:00:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [
              "email-domain-admins"
            ],
            "OnSuccess": [
              "email-domain-admins"
            ]
          }
        },
        {
          "Id": "0eb4fc0f-17f5-4603-b732-7b9b5c19ccaf",
          "Target": "S-1-5-21-639624971-2667923174-1539603190-3376",
          "Description": "Deny ryan access to pc2",
          "Type": "Computer",
          "AuthorizationMode": "SecurityDescriptor",
          "SecurityDescriptor": "O:SYD:AR(D;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
          "Jit": {
            "ExpireAfter": "00:00:00"
          },
          "Laps": {
            "ExpireAfter": "00:00:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [],
            "OnSuccess": []
          }
        }
      ]
    }
  },
  "Auditing": {
    "NotificationChannels": {
      "Smtp": [
        {
          "TemplateSuccess": "EmailAuditSuccess.html",
          "TemplateFailure": "EmailAuditFailure.html",
          "EmailAddresses": [
            "laps@lithnet.local"
          ],
          "Enabled": true,
          "Id": "email-domain-admins",
          "Mandatory": false,
          "DisplayName": "Email LAPS adminstrator"
        },
        {
          "TemplateSuccess": "EmailAuditSuccess.html",
          "TemplateFailure": "EmailAuditFailure.html",
          "EmailAddresses": [
            "support@lithnet.io"
          ],
          "Enabled": true,
          "Id": "5263b7d5-0d0d-4d05-892b-40f2e98a3f72",
          "Mandatory": false,
          "DisplayName": "Email support"
        },
        {
          "TemplateSuccess": "EmailAuditSuccess.html",
          "TemplateFailure": "EmailAuditFailure.html",
          "EmailAddresses": [
            "support@lithnet.io"
          ],
          "Enabled": true,
          "Id": "a3a619da-effb-48e4-8e6d-7a5875bec0d3",
          "Mandatory": false,
          "DisplayName": "Send email to Ryan"
        }
      ],
      "Webhooks": [
        {
          "TemplateSuccess": "TeamsTemplateSuccess.json",
          "TemplateFailure": "TeamsTemplateFailure.json",
          "Url": "https://xx",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": false,
          "Id": "teams-web-hook-da-channel",
          "Mandatory": false,
          "DisplayName": "Post to teams"
        },
        {
          "TemplateSuccess": "SlackTemplateSuccess.json",
          "TemplateFailure": "SlackTemplateFailure.json",
          "Url": "https://xx",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": false,
          "Id": "slack-web-hook-da-channel",
          "Mandatory": false,
          "DisplayName": "Post to slack"
        },
        {
          "TemplateSuccess": "SlackTemplateSuccess.json",
          "TemplateFailure": "SlackTemplateFailure.json",
          "Url": "https://slack.com/q=Sdfsdfsdfsdfdsfdsff",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": true,
          "Id": "127676fa-695c-40ef-a43c-a53aa5d023c4",
          "Mandatory": false,
          "DisplayName": "Post to #alerts channel in slack"
        }
      ],
      "Powershell": [
        {
          "Script": "AuditingSample.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "send-to-powershell",
          "Mandatory": false,
          "DisplayName": "My script"
        },
        {
          "Script": "test-script.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "3d6ca002-c40e-4622-9e18-146f5ecfc4df",
          "Mandatory": false,
          "DisplayName": "test"
        },
        {
          "Script": "AuditingSample.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "a92332b1-f05d-450d-bfef-c4596cbbd825",
          "Mandatory": false,
          "DisplayName": "my really long script name goes here"
        },
        {
          "Script": "AuditingSample.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "fa5da8fc-3bfd-49b2-844c-9d69f5d56a1b",
          "Mandatory": false,
          "DisplayName": "Log audit event to SIEM"
        }
      ]
    },
    "GlobalNotifications": {
      "OnFailure": [
        "email-domain-admins"
      ],
      "OnSuccess": [
        "email-domain-admins"
      ]
    }
  },
  "Email": {
    "Host": "smtp.lithnet.local",
    "Port": 25,
    "UseSsl": true,
    "UseDefaultCredentials": false,
    "Username": "username",
    "Password": "password1232131",
    "FromAddress": "laps@lithnet.local"
  },
  "RateLimits": {
    "PerIP": {
      "Enabled": true,
      "RequestsPerMinute": 5,
      "RequestsPerHour": 50,
      "RequestsPerDay": 100
    },
    "PerUser": {
      "Enabled": true,
      "RequestsPerMinute": 5,
      "RequestsPerHour": 50,
      "RequestsPerDay": 100
    }
  },
  "UserInterface": {
    "Title": "Lithnet Admin Access Service",
    "UserSuppliedReason": "Optional",
    "AllowLaps": true,
    "AllowJit": true,
    "AllowLapsHistory": true,
    "PhoneticSettings": {
      "UpperPrefix": "upper-case",
      "LowerPrefix": "lower-case",
      "GroupSize": 7, 
      "CharacterMappings": {
        "a": "alpha!!"
      }
    }
  },
  "ForwardedHeaders": {
    "ForwardedForHeaderName": "X-FF",
    "ForwardedHostHeaderName": "X-FH",
    "ForwardedProtoHeaderName": "X-Forwarded-Proto",
    "OriginalForHeaderName": "X-Original-For",
    "OriginalHostHeaderName": "X-Original-Host",
    "OriginalProtoHeaderName": "X-Original-Proto",
    "ForwardedHeaders": "XForwardedFor",
    "ForwardLimit": 0,
    "AllowedHosts": [
      "localhost"
    ],
    "RequireHeaderSymmetry": false,
    "KnownProxies": [
      "127.0.0.1"
    ],
    "KnownNetworks": [
      "127.0.0.1/8"
    ]
  },
  "JitConfiguration": {
    "JitGroupMappings": [
      {
        "ComputerOU": "DC=IDMDEV1,DC=LOCAL",
        "GroupOU": "OU=JIT Groups,OU=LAPS Testing,DC=IDMDEV1,DC=LOCAL",
        "GroupNameTemplate": "JIT-{computerName}",
        "GroupType": "DomainLocal"
      },
      {
        "ComputerOU": "DC=EXTDEV1,DC=LOCAL",
        "GroupOU": "OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "GroupNameTemplate": "JIT-{computerName}",
        "GroupType": "DomainLocal"
      }
    ],
    "EnableJitGroupCreation": true,
    "EnableJitGroupDeletion": true
  }
}